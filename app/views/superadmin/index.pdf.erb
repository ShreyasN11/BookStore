<div class="header" style="text-align: center; margin-bottom: 40px;">
  <% logo_file = Rails.root.join('app', 'assets', 'images', 'Logo.png') %>

    <%= image_tag wicked_pdf_asset_base64('Logo.png'), style: "width: 250px; height: auto"%>

  <h1 style="font-family: serif; font-size: 26px; font-weight: 500; margin: 0; color: #1c1917;">System Report</h1>
  <p style="color: #78716c; font-size: 14px; margin-top: 5px;">Generated on <%= Date.today.strftime("%B %d, %Y") %></p>
</div>

<div style="margin-bottom: 40px; padding: 20px; background-color: #f5f5f4; border-radius: 15px;">
  <h3 style="font-family: serif; margin-top: 0; border-bottom: 1px solid #e7e5e4; padding-bottom: 10px;">System Overview</h3>
  <p style="margin: 10px 0;"><strong>Total Active Users:</strong> <%= @total_users %></p>
  <p style="margin: 10px 0;"><strong>Total Orders Processed:</strong> <%= @total_orders %></p>
</div>

<h3 style="font-family: serif; color: #1c1917; margin-bottom: 15px;">User Directory</h3>
<table class="table" style="width: 100%; border-collapse: collapse;">
  <thead>
    <tr style="background-color: #f5f5f4;">
      <th style="padding: 12px; border: 1px solid #e7e5e4; text-align: left; font-size: 10px; text-transform: uppercase; color: #78716c;">Email</th>
      <th style="padding: 12px; border: 1px solid #e7e5e4; text-align: left; font-size: 10px; text-transform: uppercase; color: #78716c;">Role</th>
      <th style="padding: 12px; border: 1px solid #e7e5e4; text-align: left; font-size: 10px; text-transform: uppercase; color: #78716c;">Joined Date</th>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td style="padding: 12px; border: 1px solid #e7e5e4; font-size: 12px; color: #444;"><%= user.email %></td>
        <td style="padding: 12px; border: 1px solid #e7e5e4; font-size: 12px; color: #444;"><%= user.role.titleize %></td>
        <td style="padding: 12px; border: 1px solid #e7e5e4; font-size: 12px; color: #444;"><%= user.created_at.strftime("%d %b %Y") %></td>
      </tr>
    <% end %>
  </tbody>
</table>
